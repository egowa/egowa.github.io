+++
title = 'GPG 키의 목적에 대한 이해'
draft = false 
date = 2025-08-16T21:32:41+09:00
+++

![GPG key를 추상적으로 나타내는 키 아이콘](featured.png)

## GPG 키에 대해서 의문을 갖게 된 계기

리눅스 서버, 특히 우분투 서버에 패키지를 설치하려고 공식 문서를 찾다보면, 패키지 설치 이전에 GPG키를 추가하라는 안내를 하는 경우가 많다. 

지금까지는 이유를 이해하지 않은 채 그대로 코드를 복사 붙여넣기하면서 설치를 했는데 문득 이 키를 추가해야 할까라는 의문이 들기 시작했다. 그렇게 이번 글의 주제에 대해서 공부를 하기 시작했다.

## GPG란 무엇인가

### GPG

GPG란 GNU Privacy Guard의 줄임말로 해시 함수, 비대칭 암호화, 대칭 암호화 등을 다루는 프로그램이다.  

### GPG의 PGP와의 관계

GPG가 탄생하기 전에 이미 존재하던 PGP(Pretty Good Privacy)라는 프로그램이 있었는데, 이의 오픈 소스 구현체이며, 현재로서는 GPG가 표준적인 지위를 갖고 있다. 

### 헷갈릴만한 부분

GPG가 암호화 알고리즘은 아니다, GPG로 암호화한 서명 파일 등이 .gpg 확장자를 갖는 경우가 많아 GPG 키라고 불리는 것이다. 

패키지를 설치하는 과정에서 소위 GPG 키를 추가하는 것은 해시 함수와 공개키 암호화와 관련이 있는데, 해시 함수는 GPG 키의 구체적인 사용 예시에서 간략히 설명하도록 하고 우선 공개키 암호화가 무엇인지를 알아보자.

## 공개키 암호화란?

### 기본 원리

공개키 암호화란 수학적으로 쌍을 이루는 두 키를 이용해서 암호화/복호화를 하는 방식이다.

수학적으로 쌍을 이루는 두 키는 서로가 암호화한 파일에 대해서만 복호화를 할 수 있는데, 예를 들어서 수학적으로 쌍을 이루는 A, B라는 두 키가 있다고 할 때:

- A가 암호화한 파일은 B 키를 통해서만 복호화가 가능하다. 

- B가 암호화한 파일은 A 키를 통해서만 복호화가 가능하다.

### 키의 역할 구분
두 개의 키 중에서 불특정 다수에게 공개해도 되는 키를 공개키라고 하고, 개인이나 소수의 사람만이 지녀야 하는 키를 개인키라고 한다.

 (알고리즘에 따라 키의 대칭성이 다른데, RSA의 경우 수학적으로 두 키는 대칭을 이룬다. 즉, 어느 키를 공개키로 하고 개인키로 하든 상관이 없다. 물론, 효율성과 표준화를 위해 관례가 정해져 있어 정말 임의로 공개키를 정하는 경우는 없다. ECC의 경우에는 두 키가 수학적으로 비대칭적이여서 임의로 공개키를 정하면 안된다.)

### 주요 알고리즘 

공개키 암호화 알고리즘은 여러 가지가 있는데, 그 중 RSA가 대중적으로 널리 쓰인다. 이는 소인수분해와 관련된 암호화 알고리즘인데 구체적인 원리는 수학적으로 복잡하여 다루지 않겠다.

즉 두 개의 키 쌍이 있고, 암호화를 하는 사람과 복호화를 하는 사람이 서로 다른 키를 갖고 있는 암호화 방식이 공개키 암호화인 것이다.  

공개키 암호화는 개인/공개 키 중 어느 키로 암호화를 하냐에 따라 얻을 수 있는 것이 다르다.

개인 키로 암호화를 하는 경우 서명의 효과를 얻을 수 있다(누구나 복호화하여 검증을 할 수 있지만, 암호화는 개인 키를 가진 사람만 가능하므로). 
 
공개키로 암호화를 하는 경우 파일의 기밀성 유지를 위해서도 사용된다. (암호화는 누구나 가능하지만 복호화는 개인 키를 가진 사람만 가능하므로)

## 패키지 설치 이전에 GPG 키를 추가하는 이유

패키지 설치 과정에서 GPG 키를 추가하는 이유는 앞서 언급한 두 가지 이유 중에 서명, 특히 서명 검증의 용도로 쓰이는 것이다. 이를 통해서 패키지를 다운로드하는 사람은 패키지의 무결성을 확인할 수 있고, 또 패키지를 배포하는 사람을 명확히 인식하여 책임 소재를 분명히 할 수 있다.

## 구체적으로 GPG키는 어떻게 사용되는가

그렇다면 GPG 키가 어떻게 이러한 목적을 달성할 수 있을까? 구체적으로 GPG 키가 어떻게 활용되는 지를 이해해보자.

우선 패키지의 제작자가 해시 함수 (일반적으로 SHA-256)를 이용해서 패키지 파일에 대한 해시를 생성한다. 해시 함수는 파일의 디지털 지문과 같아서, 각 파일마다 고유한 해시를 생성한다. 파일에 조금이라도 변경되면 해시는 완전히 바뀌어버린다. 그리고 개인키를 통해서 이 해시를 암호화한다. 제작자는 패키지를 배포할 때 패키지 파일에 더해 이 암호화된 해시도 같이 배포한다. 이를 서명 파일이라고 부른다.

패키지를 다운로드 하고자하는 사람은 제작자가 배포하는 공개키를 먼저 다운로드한다. 그 다음 패키지와 서명을 다운로드한다.

다운로드가 완료된 후 사용자는 동일한 해시함수를 이용해서 패키지에 대한 해시를 생성한다. 

사용자는 이제 서명 파일을 공개키를 통해서 복호화를 한다. 그러면 제작자가 생성한 패키지에 대한 해시가 있을 것인데, 이를 사용자가 생성한 해시와 비교를 한다.

해시가 일치한다면 패키지가 무결하고, 또한 서명자가 배포한 패키지라는 것을 확인할 수 있다.

해시가 일치하지 않는다면 통신 과정 중 패키지가 손상되었거나, 누군가가 위/변조한 패키지일 가능성이 있다는 것이고, 이러면 패키지를 삭제하는 등의 조치를 취할 수 있다.

## 마무리

그래서 결론적으로 우분투 등에서 패키지를 다운받을 때 추가해주는 GPG 키는 공개키 암호화 방식에서 공개키에 해당한다. 이를 통해서 우리는 패키지의 무결성 확인, 서명자 검증을 할 수 있다. 

그리고 이를 통해서 비교적 적은 비용으로 추가적인 보안 계층을 얻을 수 있다는 장점이 있다. 그러나 패키지 검증 시에 서명 검증 용으로 공개키/개인키를 사용하는 것에 대해서 회의적인 시각을 보내는 사람도 있다. 

실제로 운영체제 설치를 위해 iso 파일을 설치할 때는 별도로 해시를 암호화하지 않고, 평문 해시를 제공하는 경우가 많다. 이런 경우에 서명자 검증은 할 수 없지만 파일의 위/변조 확인 여부에는 충분하다.

또한 여담으로 현재 비대칭형 암호화는 복호화 키 없이 일반적으로 복호화를 하는 데에 매우 긴 시간 동안 많은 연산력을 투자해야 한다는 점에서 보안성을 얻고 있는데, 양자 컴퓨터가 이를 무력화시킬 가능성이 높아, 이를 대비하기 위해 차세대 암호화 알고리즘을 연구하고 있다고 한다.
